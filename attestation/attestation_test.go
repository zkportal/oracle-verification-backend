package attestation

import (
	"encoding/hex"
	"fmt"
	"testing"
)

func Test_verifyNitroReport(t *testing.T) {
	// report := "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"
	// report := "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"
	report := "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"
	nonce := "698bde1e45b204ab566ad8e5f2f5d52849c4a88245c5e1a4f0b6e7bfef4f3c21"

	// reportBytes, err := base64.StdEncoding.DecodeString(report)
	// if err != nil {
	// 	t.Fatal(err)
	// }

	// signer, close, err := aleo_signer.NewSigner()
	// if err != nil {
	// 	t.Fatal(err)
	// }
	// defer close()

	// session, err := signer.NewSession()
	// if err != nil {
	// 	t.Fatal(err)
	// }
	// msg, err := session.FormatMessage(reportBytes, 10)
	// if err != nil {
	// 	t.Fatal(err)
	// }

	// os.WriteFile("formatted.txt", msg, 0666)

	userData, err := verifyNitroReport(report, nonce)
	if err != nil {
		t.Error(err)
		return
	}

	fmt.Println(hex.EncodeToString(userData))
}
